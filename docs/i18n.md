# Internationalization of the API
The DSS metadata contains a lot of verbal content: Descriptions, titles etc that are used throughout the platform, hence they need translations to as many languages as possible. Internally, the translations are stored as ResourceBundles, which is a Java native way of keeping track of translations.

Translations are stored in CSV files, one file per Source DSS. E.g. VIPS has one file for all DSS models, SEGES has one, ADAS one etc. To ease the process for non-technical personell, the process has (hopefully) been grossly simplified. The old documentation (which is still valid) can be found [here](./i18n_old.md)

## Information for translators
You will perform the translations using Excel in the cloud. So, for instance
![Excel screenshot](excel_screenshot.png)


The translations are key-based, using a namespace that is built up like this:

```
[DSS Source ID].[DSS source version].models.[Model ID].[property.path]
```
For instance 

If you are adding your language for the first time to a DSS, all cells in your column (which you create yourself) must be filled in. If you are editing a translation, only the cells that have been changed (marked with a yellow background colour) need to be edited. When you are done, set the background color of your cells to none/white.

## Translation workflow (technical)
### Preparing the CSV file
#### New DSS
Assuming that 
* a metadata file has been created for the new DSS and 
* said file has been deployed to the test version of the DSS API

##### Create new CSV file
Create a fresh CSV file by querying this endpoint:

```
https://ipmdecisions.nibio.no/api/dss/rest/admin/dss/{DSS ID}/i18n/csv/
```

The {DSS ID} should be replaced by whatever DSS ID, for instance like this for the ADAS DSS:

[https://ipmdecisions.nibio.no/api/dss/rest/admin/dss/adas.dss/i18n/csv/](https://ipmdecisions.nibio.no/api/dss/rest/admin/dss/adas.dss/i18n/csv/)

##### Add to repository
Create a branch of DSS-Metadata that reflects this addition, named e.g. add-DSS-DSS_ID, and commit the file to this branch. Push it to GitHub

#### Existing DSS with new model(s) or revised metadata (original language)
##### Commit YAML file to new branch (if not already existing as pull request)
Create a branch of DSS-Metadata that reflects the change, named e.g. edit-DSS-DSS_ID, and commit the edited YAML file to this branch. Push it to GitHub

##### Upload the original CSV file to "the cloud"
You have to convert it to Excel by using the script `i18n/csv_split_into_models.py`. The produced files can be found in the `excel` folder. Example usage:

```bash
$ csv_split_into_models.py *.csv
```
Upload the Excel files to a Teams or Sharepoint where the translators can work on the same file simultaneously.

##### Identify modifications from main branch - 
Use a diff tool to identify changes between the original and edited YAML file. 